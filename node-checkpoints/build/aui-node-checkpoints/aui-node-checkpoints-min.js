YUI.add("aui-node-checkpoints",function(e,t){var n=e.getBody(),r={},i=function(e){return e===n},s=function(){this.init.apply(this,arguments)};s.DEFAULTS={axis:"vertical",enabled:!0,triggerAtTheEnd:!1,offset:0},s.prototype.init=function(t,n,r){var i=this;e.mix(r,s.DEFAULTS),i._axis=r.axis,i._callback=n,i._context=r._context,i._enabled=r.enabled,i._node=t,i._offset=r.offset,i._triggerAtTheEnd=r.triggerAtTheEnd,i._scrollEvent={vertical:t.get("scrollTop"),horizontal:t.get("scrollLeft")},i.bindResizeUI(),i.bindScrollUI(),i._handles=[i._resizeHandler,i._scrollHandler]},s.prototype.bindResizeUI=function(){var t=this,n=t._node,r=e.bind(t.refresh,t),s;i(n)?s=n.on("resize",e.debounce(r,400)):s=n.on("resize:end",r),t._resizeHandler=s},s.prototype.bindScrollUI=function(){var e=this,t;e._triggerAtTheEnd?t=e._context.on(e._axis==="vertical"?"scrollToBottom":"scrollToRight",function(t){e._enabled&&(e._scrollEvent=t,e._triggerCallback())},e):(e._reachedCheckpoint=e.reachedCheckpoint(),t=e._context.on("scroll",function(t){e._enabled&&(e._scrollEvent=t,e._crossed()&&e._triggerCallback())},e)),e._scrollHandler=t},s.prototype._crossed=function(){var e=this,t=e.reachedCheckpoint(),n=t!==e._reachedCheckpoint;return e._reachedCheckpoint=t,n},s.prototype._getEventScrollDirection=function(){var e=this,t=e._scrollEvent,n;return t.isScrollDown?n="down":t.isScrollLeft?n="left":t.isScrollRight?n="right":t.isScrollUp&&(n="up"),n},s.prototype.destroy=function(){var t=this;e.Array.invoke(t._handles,"detach")},s.prototype.disable=function(){var e=this;e._enabled=!1},s.prototype.enable=function(){var e=this;e._enabled=!0,e.refresh()},s.prototype.getContext=function(){var e=this;return e._context},s.prototype.getNode=function(){var e=this;return e._node},s.prototype.getOffset=function(){var e=this;return e._offset},s.prototype.reachedCheckpoint=function(){var e=this,t=e._getScrollPosition(),n=e._getTriggerPosition(),r=t>=n;return r},s.prototype.refresh=function(){var e=this;e._triggerPosition&&delete e._triggerPosition,e._reachedCheckpoint=e.reachedCheckpoint()},s.prototype.setOffset=function(e){var t=this;t._offset=e},s.prototype._getScrollPosition=function(){var e=this,t=e._scrollEvent,n=e._axis==="vertical"?t.scrollTop:t.scrollLeft;return n},s.prototype._getTriggerPosition=function(){var e=this,t=e._triggerPosition;if(!t){var n=e._axis==="vertical"?"offsetTop":"offsetLeft",r=e._node.get(n),s=e._context.getNode(),o=i(s)?0:s.get(n),u=e._offset;t=r-o-u,e._triggerPosition=t}return t},s.prototype._triggerCallback=function(){var e=this,t=e._getEventScrollDirection();e._callback(t)};var o=function(e){o.superclass.constructor.apply(this,arguments)};o.get=function(t){t=t||{},t=e.mix(t,o.DEFAULTS);var n=e.stamp(t.node),i=o.getById(n);return i||(i=new o(t),r[n]=i),i},o.getById=function(e){return r[e]},o.DEFAULTS={enabled:!0,node:n},e.extend(o,e.Base,{init:function(e){var t=this;t._enabled=e.enabled,t._node=e.node,t._offset={},t.bindUI()},bindUI:function(){var t=this,n=t._node;n.plug(e.Plugin.ScrollInfo,{scrollDelay:0});var r=n.scrollInfo.on("scroll",function(e){t._enabled&&t.fire("scroll",e)},t),i=n.scrollInfo.on("scrollToBottom",function(e){t._enabled&&t.fire("scrollToBottom",e)},t),s=n.scrollInfo.on("scrollToRight",function(e){t._enabled&&t.fire("scrollToRight",e)},t);t._handles=[r,i,s]},destroy:function(){var t=this;e.Array.invoke(t._handles,"detach")},enable:function(){var e=this;e._enabled=!0},disable:function(){var e=this;e._enabled=!1},getNode:function(){var e=this;return e._node}}),e.Node.prototype.checkpoint=function(t,n){n=n||{};var r=n._context;if(!r){var i=n.context;if(i){var u=e.one(i);u&&(i={node:u})}r=o.get(i)}n._context=r,new s(this,t,n)},e.NodeList.prototype.checkpoint=function(){var t=arguments;return e.NodeList.each(this,function(n){e.Node.prototype.checkpoint.apply(e.one(n),t)}),this},e.Node.Checkpoint=s},"2.5.0",{requires:["array-invoke","aui-base","node-scroll-info","resize-base"]});
